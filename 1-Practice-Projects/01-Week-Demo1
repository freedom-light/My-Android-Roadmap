package com.example.oneweektodolisttmp

import android.os.Bundle
import androidx.activity.enableEdgeToEdge
import androidx.appcompat.app.AppCompatActivity
import androidx.core.view.ViewCompat
import androidx.core.view.WindowInsetsCompat
import android.widget.Button
import android.widget.EditText
import android.widget.ListView
import android.widget.ArrayAdapter
import android.widget.Toast

class MainActivity : AppCompatActivity() {
    val textList = mutableListOf<String>()
    lateinit var addButton : Button
    lateinit var taskInput: EditText
    lateinit var viewList: ListView
    lateinit var adapter: ArrayAdapter<String>

    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
        enableEdgeToEdge()
        setContentView(R.layout.activity_main)

        // 确保你的应用内容不会被系统的 UI（如状态栏、导航栏）遮挡
        ViewCompat.setOnApplyWindowInsetsListener(findViewById(R.id.main)) { v, insets ->
            val systemBars = insets.getInsets(WindowInsetsCompat.Type.systemBars())
            v.setPadding(systemBars.left, systemBars.top, systemBars.right, systemBars.bottom)
            insets
        }

        addButton = findViewById(R.id.AddButton)
        taskInput = findViewById(R.id.taskInput)
        viewList = findViewById(R.id.viewList)
        
        // 创建，绑定适配器
        adapter = ArrayAdapter(this, android.R.layout.simple_list_item_1, textList)
        viewList.adapter = adapter
        
        // 绑定点击事件
        addButton.setOnClickListener{
            addTask()
        }
        viewList.setOnItemClickListener{_, _, position, _->
            removeView(position)
            true
        }
    }
    
    // 添加任务
    fun addTask(){
        val task = taskInput.text.toString()
        if(task.isNotEmpty()){
            textList.add(task)
            adapter.notifyDataSetChanged()
            taskInput.text.clear()
        }
    }
    // 单击删除任务
    fun removeView(position: Int){
        textList.removeAt(position)
        adapter.notifyDataSetChanged()
        Toast.makeText(this, "删除成功", Toast.LENGTH_SHORT).show()
    }

}
